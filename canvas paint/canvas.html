<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Canvas paint</title>
    <link rel="stylesheet" type="text/css" href="css/canvas.css">
</head>
<body style="margin: 0;">
    <canvas id="canvas" style="display: block;">Your browser is not supported. U mad bro.</canvas>

    <script type="text/javascript">

        // Help
        alert('       Как пользоваться этой программой.\nЧтобы сохранить рисунок надо нажать s на клавиатуре.\nЧтобы стереть рисунок нужно нажать c на клавиатуре.\nЧтобы воспроизвести нужно нажать r на клавиатуре.\nЧто делает эта программа, она выводит то ,что вы нарисовали на экран по времени.\nНапример: вы нарисовали дом.\n1:Затем зажимайте кнопку сохранить.\n2:Потом нажимайте кнопку воспроизвести r чтобы ,то что вы нарисовали нарисовалось по линиям за 10 миллисекунд.\n3:Если хотите нарисовать другое , то нажмите кнопку стереть c. \nИ делайте также как в 1 и 2 пункте.\nНа заметку на телефонах это программа не работает там не стационарной клавиатуры.\nТак что только на Пк или подключайте к телефону клавиатуру от Пк.\nP.S Кнопки с маленькай буквы нажимать.\nНе забудьте поставить английскую раскладку!');


        // Start

        var 
            canv = document.getElementById('canvas'),
            ctx  = canv.getContext('2d'),
            isMouseDown = false,
            coords = [],
            radius = 11;

        canv.width = window.innerWidth;
        canv.height = window.innerHeight;

        // Code
        
        canv.addEventListener('mousedown', function () {
            isMouseDown = true;
        });

        canv.addEventListener('mouseup' , function () {
            isMouseDown = false;
            ctx.beginPath();
            coords.push('mouseup');
        });

        ctx.lineWidth = radius * 2;
        canv.addEventListener('mousemove', function (e) {

            if ( isMouseDown) 
            {
                coords.push([e.clientX, e.clientY]);
                ctx.lineTo(e.clientX, e.clientY);
                ctx.stroke();

                ctx.beginPath();
                ctx.arc(e.clientX, e.clientY, radius, 0, Math.PI * 2);
                ctx.fill();

                ctx.beginPath();
                ctx.moveTo(e.clientX, e.clientY);

            }
        });

        function save() {
            localStorage.setItem('coords', JSON.stringify(coords));
        }

        function clear() {
            ctx.fillStyle = 'white';
            ctx.fillRect(0,0, canv.width, canv.height);

            ctx.beginPath();
            ctx.fillStyle = 'black';
        }

        function replay() {
            var 
                timer = setInterval(function () {
                    if ( !coords.length ) {
                        clearInterval(timer);
                        ctx.beginPath();
                        return;
                    }

                    var 
                        crd = coords.shift(),
                        e = {
                            clientX: crd['0'],
                            clientY: crd['1']
                        };
                    ctx.lineTo(e.clientX, e.clientY);
                    ctx.stroke();

                ctx.beginPath();
                ctx.arc(e.clientX, e.clientY, radius, 0, Math.PI * 2);
                ctx.fill();

                ctx.beginPath();
                ctx.moveTo(e.clientX, e.clientY);

                }, 10);
        }

        document.addEventListener('keydown', function (e) {
            if (e.keyCode == 83) {

                console.log('Saved');
                // save button on the keyboard s 
                save();
            }

            if (e.keyCode == 82) {
                console.log('Replaying');
                // replay button on the keyboard r
                coords = JSON.parse(localStorage.getItem('coords'));
                clear();
                replay();
            }

            if (e.keyCode == 67) {
                console.log('Clear');
                // clear button on the keyboard c 
                clear();       
            }
        });
    </script>
</body>
</html>